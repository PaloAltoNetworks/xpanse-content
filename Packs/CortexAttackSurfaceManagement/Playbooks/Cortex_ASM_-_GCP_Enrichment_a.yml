id: Cortex ASM - GCP Enrichment
version: -1
name: Cortex ASM - GCP Enrichment
description: Given the IP address this playbook enriches GCP and Firewall information.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 7feb7b51-3509-4e44-806d-74f21d68fe3d
    type: start
    task:
      id: 7feb7b51-3509-4e44-806d-74f21d68fe3d
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 947.5,
          "y": -20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: 1b362f3c-ccf8-41e2-8db9-b3eef449694b
    type: playbook
    task:
      id: 1b362f3c-ccf8-41e2-8db9-b3eef449694b
      version: -1
      name: GCP - Enrichment
      description: Given the IP address this playbook enriches GCP and Firewall information.
      type: playbook
      iscommand: false
      brand: ""
      playbookId: GCP - Enrichment
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      GcpIP:
        complex:
          root: inputs.RemoteIP
      port:
        complex:
          accessor: remoteport
          root: alert
          transformers:
          - operator: FirstArrayElement
      protocol:
        simple: ${alert.asmprotocol}
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 947.5,
          "y": 125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 2528b339-7c9d-4314-8958-95a2d1704e4a
    type: title
    task:
      id: 2528b339-7c9d-4314-8958-95a2d1704e4a
      version: -1
      name: Set Field
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
      - "5"
      - "3"
      - "31"
      - "68"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 947.5,
          "y": 300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: a65de7c9-a2ed-41e3-80ed-016616ed5a4b
    type: condition
    task:
      id: a65de7c9-a2ed-41e3-80ed-016616ed5a4b
      version: -1
      name: Is there VM and IAM information?
      description: Determines if there is EC2 information to set the private IP, cloud, and tags fields.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "14"
      - "17"
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2040,
          "y": 445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 0754fabb-f969-40a0-89eb-13b5871373d3
    type: condition
    task:
      id: 0754fabb-f969-40a0-89eb-13b5871373d3
      version: -1
      name: Is there IAM information?
      description: Determines if there is IAM information to set in the service owner field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPIAM.Policy.bindings
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPIAM.Policy.bindings.role
                      iscontext: true
                    right:
                      value:
                        simple: roles/owner
                accessor: members
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -600,
          "y": 445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: a20e0684-13f7-4d2a-88f8-c42ef6e03b95
    type: condition
    task:
      id: a20e0684-13f7-4d2a-88f8-c42ef6e03b95
      version: -1
      name: Is there VM and firewall information?
      description: Determines if there is EC2 and security group information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 947.5,
          "y": 445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: fefb2be2-6433-41d8-8f2a-66d51d173985
    type: regular
    task:
      id: fefb2be2-6433-41d8-8f2a-66d51d173985
      version: -1
      name: Set service owner grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      gridfield:
        simple: asmserviceownerunrankedraw
      keys:
        simple: name,email,source,timestamp,accounttype
      val1:
        simple: n/a
      val2:
        complex:
          root: GCPIAM.Policy.bindings
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPIAM.Policy.bindings.role
                iscontext: true
              right:
                value:
                  simple: roles/owner
          accessor: members
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: 'user:'
      val3:
        simple: GCP
      val4:
        simple: TIMESTAMP
      val5:
        simple: USER-ACCOUNT
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -600,
          "y": 825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 177ad709-c8da-45c3-8936-c8a475475f37
    type: title
    task:
      id: 177ad709-c8da-45c3-8936-c8a475475f37
      version: -1
      name: Service Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -600,
          "y": 670
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 240f2559-563b-491d-8741-a26b1240de55
    type: regular
    task:
      id: 240f2559-563b-491d-8741-a26b1240de55
      version: -1
      name: Set private IP grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: ip,source
      val1:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: networkIP
          transformers:
          - operator: uniq
      val2:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2322.5,
          "y": 935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: ebcc258d-0fa2-441e-8bb1-93ff8ed80e12
    type: title
    task:
      id: ebcc258d-0fa2-441e-8bb1-93ff8ed80e12
      version: -1
      name: Private IP
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2322.5,
          "y": 795
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 8d09a82a-5919-4e0e-833e-92fc51c5f32b
    type: title
    task:
      id: 8d09a82a-5919-4e0e-833e-92fc51c5f32b
      version: -1
      name: Cloud
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: ffb23ec5-2d70-4d36-8849-92d797a635cd
    type: regular
    task:
      id: ffb23ec5-2d70-4d36-8849-92d797a635cd
      version: -1
      name: Set cloud grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: provider,organization,project,region,other
      val1:
        simple: GCP
      val2:
        simple: n/a
      val3:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: ExtractInbetween
            args:
              from:
                value:
                  simple: projects/
              to:
                value:
                  simple: /global
          filters:
          - - left:
                iscontext: true
                value:
                  simple: GoogleCloudCompute.Instances.networkInterfaces.accessConfigs.natIP
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: inputs.RemoteIP
      val4:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
      val5:
        complex:
          root: folder-ids
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a1922954-9b42-4590-8d04-81d7e70271aa
    type: title
    task:
      id: a1922954-9b42-4590-8d04-81d7e70271aa
      version: -1
      name: Tags
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2822.5,
          "y": 760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 0478ff04-6a02-4fb3-8929-fbe08c7d56f1
    type: regular
    task:
      id: 0478ff04-6a02-4fb3-8929-fbe08c7d56f1
      version: -1
      name: Set tags grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: key,value,source
      val1:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: keys(@)
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: values(@)
      val3:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2822.5,
          "y": 1110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 48668ed0-8027-44c8-8b10-8a2e7d33886b
    type: title
    task:
      id: 48668ed0-8027-44c8-8b10-8a2e7d33886b
      version: -1
      name: System IDs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: bb3d1e4e-5fa8-48ed-8e0c-32df2335f173
    type: regular
    task:
      id: bb3d1e4e-5fa8-48ed-8e0c-32df2335f173
      version: -1
      name: Set system IDs grid field (VPC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-VIRTUAL-NET
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: uniq
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GoogleCloudCompute.Instances.networkInterfaces.accessConfigs.natIP
                iscontext: true
              right:
                value:
                  simple: inputs.RemoteIP
                iscontext: true
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 87a29f9b-dd60-47e7-8829-12efbbb4b721
    type: regular
    task:
      id: 87a29f9b-dd60-47e7-8829-12efbbb4b721
      version: -1
      name: Set system IDs grid field (subnet name)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SUBNET-NAME
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: subnetwork
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ddc9b46e-4ffe-415b-8df7-f1fba4eca83f
    type: regular
    task:
      id: ddc9b46e-4ffe-415b-8df7-f1fba4eca83f
      version: -1
      name: Set system IDs grid field (NIC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-NIC
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 9e56698b-2b16-472d-8ed2-a9879f396cd2
    type: regular
    task:
      id: 9e56698b-2b16-472d-8ed2-a9879f396cd2
      version: -1
      name: Set system IDs grid field (GCE ID)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ID
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: id
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: 865ae9f9-aa78-4268-83b1-c2d322589819
    type: regular
    task:
      id: 865ae9f9-aa78-4268-83b1-c2d322589819
      version: -1
      name: Set system IDs grid field (ZONE)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ZONE
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=zones\/)[^$]+
              unpack_matches: {}
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 72fd27db-91f6-4106-876d-b5f01fa105fb
    type: regular
    task:
      id: 72fd27db-91f6-4106-876d-b5f01fa105fb
      version: -1
      name: Set system IDs grid field (GCE name)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-NAME
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 44468271-b47c-4b92-8887-5432a771e7eb
    type: condition
    task:
      id: 44468271-b47c-4b92-8887-5432a771e7eb
      version: -1
      name: Are there any tags?
      description: |+
        Check whether there are any tags associated to instances.

      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      - "71"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute.Instances
                accessor: labels
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2822.5,
          "y": 890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: 6bbed928-4d85-426d-8c74-f633e7a51d50
    type: condition
    task:
      id: 6bbed928-4d85-426d-8c74-f633e7a51d50
      version: -1
      name: Is service account field set?
      description: Determines if a service account associated with the Cloud Compute Instance was discovered and set on the alert.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "63"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: GoogleCloudCompute.Instances.serviceAccounts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: eb180a33-afe7-4e44-8543-f6f47d729733
    type: regular
    task:
      id: eb180a33-afe7-4e44-8543-f6f47d729733
      version: -1
      name: Add service account to unranked service owner list
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "65"
    scriptarguments:
      gridfield:
        simple: asmserviceownerunrankedraw
      keys:
        simple: name,email,source,timestamp,accounttype
      val1:
        simple: n/a
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: serviceAccounts
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: email
      val3:
        simple: GCP
      val4:
        simple: TIMESTAMP
      val5:
        simple: SERVICE-ACCOUNT
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 240,
          "y": 815
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 5280fb68-ba1b-406f-8862-0b6b43e09179
    type: condition
    task:
      id: 5280fb68-ba1b-406f-8862-0b6b43e09179
      version: -1
      name: Is there GCP project hierarchy information?
      description: Determines if there is GCP hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPHierarchy.level
                      iscontext: true
                    right:
                      value:
                        simple: project
                accessor: number
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: cf941c56-5919-44ba-8318-f3963ec2c96d
    type: regular
    task:
      id: cf941c56-5919-44ba-8318-f3963ec2c96d
      version: -1
      name: Set system IDs grid field (Project-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: GCP-Project-Number
      val2:
        complex:
          root: GCPHierarchy
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPHierarchy.level
                iscontext: true
              right:
                value:
                  simple: project
          accessor: number
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: projects/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 6a7c013f-a69b-4f66-89bd-01e64e84e7f8
    type: condition
    task:
      id: 6a7c013f-a69b-4f66-89bd-01e64e84e7f8
      version: -1
      name: Is there GCP folder hierarchy information?
      description: Determines if there is GCP folder hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy.number
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: GCPHierarchy.number
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 42caadb8-ab66-491f-8a63-f00f778e906c
    type: regular
    task:
      id: 42caadb8-ab66-491f-8a63-f00f778e906c
      version: -1
      name: Set system IDs grid field (Folder-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: GCP-Folder-Number
      val2:
        complex:
          root: GCPHierarchy.number
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: GCPHierarchy.number
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: folders/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 33ebb54c-b941-4d57-86c4-9da3d6957981
    type: regular
    task:
      id: 33ebb54c-b941-4d57-86c4-9da3d6957981
      version: -1
      name: Set Folders
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        complex:
          root: GCPHierarchy.id
          filters:
          - - operator: startWith
              left:
                value:
                  simple: GCPHierarchy.id
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1802.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 097e8225-a777-40db-85cb-06c4fc006c3c
    type: regular
    task:
      id: 097e8225-a777-40db-85cb-06c4fc006c3c
      version: -1
      name: Set Folders to n/a
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1402.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 93a029ed-05f3-4800-8db7-993015f6b571
    type: condition
    task:
      id: 93a029ed-05f3-4800-8db7-993015f6b571
      version: -1
      name: Are there any folders?
      description: Determines if there is GCP folder information to set in the cloud field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPHierarchy.id
                filters:
                - - operator: startWith
                    left:
                      value:
                        simple: GCPHierarchy.id
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 875
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: c3f10bb7-0342-41e9-8d43-782a2dcc7e4e
    type: title
    task:
      id: c3f10bb7-0342-41e9-8d43-782a2dcc7e4e
      version: -1
      name: Service Owner - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -610,
          "y": 1365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 1c9c1c40-2423-4014-845a-37088b1cd1f3
    type: regular
    task:
      id: 1c9c1c40-2423-4014-845a-37088b1cd1f3
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "43"
      - "40"
      - "64"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -190,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: e39f1ba1-fa24-42c3-8f8d-880dead33cda
    type: regular
    task:
      id: e39f1ba1-fa24-42c3-8f8d-880dead33cda
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": -600,
          "y": 995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 42c9777b-c527-42af-8344-bcc66462ae24
    type: title
    task:
      id: 42c9777b-c527-42af-8344-bcc66462ae24
      version: -1
      name: System IDs - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 680,
          "y": 3550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: d2662b08-b076-4d15-8212-0e03d114b15b
    type: title
    task:
      id: d2662b08-b076-4d15-8212-0e03d114b15b
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 4280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: 8a0a59a7-4b1a-4c2e-8638-ea14a0f6e0a3
    type: title
    task:
      id: 8a0a59a7-4b1a-4c2e-8638-ea14a0f6e0a3
      version: -1
      name: Closing Steps
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: title
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 60d77afc-ccdd-4bbb-8f92-45f008db9097
    type: regular
    task:
      id: 60d77afc-ccdd-4bbb-8f92-45f008db9097
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: a7471055-3435-451b-8d46-a83a47e38d1f
    type: regular
    task:
      id: a7471055-3435-451b-8d46-a83a47e38d1f
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2040,
          "y": 1655
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: d0c2aab6-f40f-4702-8779-91dc03a1a5e4
    type: title
    task:
      id: d0c2aab6-f40f-4702-8779-91dc03a1a5e4
      version: -1
      name: Tags - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2822.5,
          "y": 1475
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 14cf8826-78f0-4add-807c-bde0e27d9c69
    type: regular
    task:
      id: 14cf8826-78f0-4add-807c-bde0e27d9c69
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2322.5,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: 1c4f61a0-72c0-40a5-881f-84a06443607e
    type: title
    task:
      id: 1c4f61a0-72c0-40a5-881f-84a06443607e
      version: -1
      name: Private IP - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2322.5,
          "y": 1325
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 4c796813-cb26-4b47-8ef6-40c8154e69fe
    type: regular
    task:
      id: 4c796813-cb26-4b47-8ef6-40c8154e69fe
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2822.5,
          "y": 1280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: b35871a1-21d8-42f4-819a-98de31daa854
    type: regular
    task:
      id: b35871a1-21d8-42f4-819a-98de31daa854
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 1645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: b36673e4-a1d3-4069-8129-89f34b4d804d
    type: title
    task:
      id: b36673e4-a1d3-4069-8129-89f34b4d804d
      version: -1
      name: Cloud - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 2a9c0940-6694-4824-86d5-a1849a63c0b4
    type: regular
    task:
      id: 2a9c0940-6694-4824-86d5-a1849a63c0b4
      version: -1
      name: Set ASM enrichment status to true
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        simple: "true"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1772.5,
          "y": 4110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: bb857fd4-e8ef-4100-8b8e-2f0e16f5b332
    type: condition
    task:
      id: bb857fd4-e8ef-4100-8b8e-2f0e16f5b332
      version: -1
      name: Was enrichment performed?
      description: Check if enrichment was performed by checking for a value of true in the relevant flag variable.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: asm_enrichment_flag_gcp
            iscontext: true
          right:
            value:
              simple: "true"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 3890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: ff91aa2c-7df5-415d-8cf1-2dec4aa9728c
    type: regular
    task:
      id: ff91aa2c-7df5-415d-8cf1-2dec4aa9728c
      version: -1
      name: Set ASM enrichment status to false
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        simple: "false"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 4110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: a54dd7ed-7c88-4d26-8aa5-aaa408e17d7e
    type: regular
    task:
      id: a54dd7ed-7c88-4d26-8aa5-aaa408e17d7e
      version: -1
      name: Set system IDs grid field (type)
      description: Sets the type of cloud asset to the grid field for the ASM system IDs object.
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-TYPE
      val2:
        simple: Google Compute Engine
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 10375d43-797a-4ba4-849c-05e62793ad71
    type: condition
    task:
      id: 10375d43-797a-4ba4-849c-05e62793ad71
      version: -1
      name: Is there GCP subnet information?
      description: Determines if there is GCP subnet information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "47"
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GoogleCloudCompute.Instances.networkInterfaces
                accessor: subnetwork
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 30520959-d9ea-48e3-88b9-cc86b4740a30
    type: regular
    task:
      id: 30520959-d9ea-48e3-88b9-cc86b4740a30
      version: -1
      name: Set hierarchy field
      description: commands.local.cmd.set.incident
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      asmassethierarchy:
        complex:
          root: GCPHierarchy
          accessor: id
          transformers:
          - operator: ReverseList
          - operator: substringFrom
            args:
              from:
                value:
                  simple: /
          - operator: join
            args:
              separator:
                value:
                  simple: /
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1597.5,
          "y": 1475
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: GCPOffendingFirewallRule
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there are GCP potential offending firewall rule(s) found.
      id: 7d64f3b5-5768-47d7-8297-be58723feef7
      iscommand: false
      name: Were GCP offending firewall rule(s) found?
      type: condition
      version: -1
    taskid: 7d64f3b5-5768-47d7-8297-be58723feef7
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2330
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: FIREWALL-RULE-NAME
      val2:
        simple: ${GCPOffendingFirewallRule}
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 59900880-5537-4ff7-86f7-8adbebba2306
      iscommand: false
      name: Set system IDs grid field (offending firewall rule(s))
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 59900880-5537-4ff7-86f7-8adbebba2306
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2520
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "32"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e44b62a0-7a70-4add-8947-cdbb66bb4976
      iscommand: false
      name: Service Account
      type: title
      version: -1
      description: ''
    taskid: e44b62a0-7a70-4add-8947-cdbb66bb4976
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 240,
          "y": 670
        }
      }
  "64":
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "45"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 729f5e4f-4a49-4fb7-8b31-0b254b2d6708
      iscommand: false
      name: Service Account - End
      type: title
      version: -1
      description: ''
    taskid: 729f5e4f-4a49-4fb7-8b31-0b254b2d6708
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 240,
          "y": 1375
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "64"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 7cbc2384-d63b-4272-8c79-8186485fecd6
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: 7cbc2384-d63b-4272-8c79-8186485fecd6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 240,
          "y": 995
        }
      }
  "66":
    id: "66"
    taskid: 895635cc-3f0b-4fe7-8806-707261d27b22
    type: regular
    task:
      id: 895635cc-3f0b-4fe7-8806-707261d27b22
      version: -1
      name: Set tags grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: Key,Value,Source
      val1:
        complex:
          root: GCPIAM.TagBindings
          accessor: key
      val2:
        complex:
          root: GCPIAM.TagBindings
          accessor: value
      val3:
        simple: GCP-project-folder-tags
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3760,
          "y": 975
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "67":
    id: "67"
    taskid: 94227a1a-9996-41af-8e2c-7e80a074cea8
    type: title
    task:
      id: 94227a1a-9996-41af-8e2c-7e80a074cea8
      version: -1
      name: Tags - Project/Folder/Organization Tags
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "66"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3760,
          "y": 830
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "68":
    id: "68"
    taskid: b98b42bb-c6de-4896-84fe-c144fd995cc6
    type: condition
    task:
      id: b98b42bb-c6de-4896-84fe-c144fd995cc6
      version: -1
      name: Is there tagbinding information?
      description: Determines if there is GCP-IAM tagbindings information to populate tags field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "71"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPIAM
                accessor: TagBindings
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3760,
          "y": 445
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "69":
    id: "69"
    taskid: 652e3ddd-0896-43d4-81e8-804d84e96e07
    type: title
    task:
      id: 652e3ddd-0896-43d4-81e8-804d84e96e07
      version: -1
      name: Project/Folder/Organization Tags - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3760,
          "y": 1315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "70":
    id: "70"
    taskid: 54252279-55f2-4dbd-810c-b1c848213a00
    type: regular
    task:
      id: 54252279-55f2-4dbd-810c-b1c848213a00
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3760,
          "y": 1135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "71":
    id: "71"
    taskid: 30c4c161-f926-4a84-8e86-d9772c36054b
    type: regular
    task:
      id: 30c4c161-f926-4a84-8e86-d9772c36054b
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 3342.5,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "29_18_yes": 0.56,
      "29_71_#default#": 0.52,
      "31_41_#default#": 0.47,
      "33_34_yes": 0.5,
      "33_43_#default#": 0.11,
      "35_36_yes": 0.54,
      "35_43_#default#": 0.2,
      "39_37_yes": 0.63,
      "39_38_#default#": 0.65,
      "3_17_yes": 0.76,
      "4_41_#default#": 0.4,
      "59_22_yes": 0.49,
      "5_41_#default#": 0.41,
      "68_71_#default#": 0.45
    },
    "paper": {
      "dimensions": {
        "height": 4365,
        "width": 4750,
        "x": -610,
        "y": -20
      }
    }
  }
inputs:
- key: RemoteIP
  value:
    complex:
      root: alert
      accessor: remoteip
  required: false
  description: IP address of service
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.8.0
