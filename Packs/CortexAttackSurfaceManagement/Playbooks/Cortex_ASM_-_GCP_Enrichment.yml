id: Cortex ASM - GCP Enrichment
version: -1
name: Cortex ASM - GCP Enrichment
description: Given the IP address this playbook enriches GCP and Firewall information.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 86776180-c880-4d16-8e6b-482b5a992655
    type: start
    task:
      id: 86776180-c880-4d16-8e6b-482b5a992655
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: df31f6fd-d7f0-44c1-829f-dc63172cf082
    type: playbook
    task:
      id: df31f6fd-d7f0-44c1-829f-dc63172cf082
      version: -1
      name: GCP - Enrichment
      description: Given the IP address this playbook enriches GCP and Firewall information.
      type: playbook
      iscommand: false
      brand: ""
      playbookId: GCP - Enrichment
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      GcpIP:
        complex:
          root: inputs.RemoteIP
      port:
        complex:
          accessor: remoteport
          root: alert
          transformers:
          - operator: FirstArrayElement
      protocol:
        simple: ${alert.protocol}
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 165
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: dca53ca5-e46c-41b8-8832-e966a16ae3c5
    type: title
    task:
      id: dca53ca5-e46c-41b8-8832-e966a16ae3c5
      version: -1
      name: Set Field
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "4"
      - "5"
      - "3"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 2cde6ffe-7d89-472a-89db-10e0e07be357
    type: condition
    task:
      id: 2cde6ffe-7d89-472a-89db-10e0e07be357
      version: -1
      name: Is there VM and IAM information?
      description: Determines if there is EC2 information to set the private IP, cloud, and tags fields.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "48"
      "yes":
      - "14"
      - "17"
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2010,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 7990576e-cc8c-4429-882d-28c8f409ea71
    type: condition
    task:
      id: 7990576e-cc8c-4429-882d-28c8f409ea71
      version: -1
      name: Is there IAM information?
      description: Determines if there is IAM information to set in the service owner field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPIAM.Policy.bindings
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPIAM.Policy.bindings.role
                      iscontext: true
                    right:
                      value:
                        simple: roles/owner
                accessor: members
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 5bb2044c-229b-4d3f-8c1b-a5ad73912f18
    type: condition
    task:
      id: 5bb2044c-229b-4d3f-8c1b-a5ad73912f18
      version: -1
      name: Is there VM and firewall information?
      description: Determines if there is EC2 and security group information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute
                accessor: Instances
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 877.5,
          "y": 485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: 95d5da7a-b449-4207-8ef8-62d2e100689a
    type: regular
    task:
      id: 95d5da7a-b449-4207-8ef8-62d2e100689a
      version: -1
      name: Add service owner (user) to unranked service owner list
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      gridfield:
        simple: asmserviceownerunrankedraw
      keys:
        simple: name,email,source,timestamp
      val1:
        simple: n/a
      val2:
        complex:
          root: GCPIAM.Policy.bindings
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPIAM.Policy.bindings.role
                iscontext: true
              right:
                value:
                  simple: roles/owner
          accessor: members
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: 'user:'
      val3:
        simple: GCP-USER-ACCOUNT
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 850
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 9518f5a0-e575-4d40-8d7d-5d5bf16d9ab8
    type: title
    task:
      id: 9518f5a0-e575-4d40-8d7d-5d5bf16d9ab8
      version: -1
      name: Service Owner
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 700
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: 635b316f-35c7-46f2-8154-6874e3336cfb
    type: regular
    task:
      id: 635b316f-35c7-46f2-8154-6874e3336cfb
      version: -1
      name: Set private IP grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "50"
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: ip,source
      val1:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: networkIP
          transformers:
          - operator: uniq
      val2:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 12f0a3a7-8472-4863-8557-483339a937aa
    type: title
    task:
      id: 12f0a3a7-8472-4863-8557-483339a937aa
      version: -1
      name: Private IP
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 5fc2212e-a610-4ecc-8246-91f472d48cdb
    type: title
    task:
      id: 5fc2212e-a610-4ecc-8246-91f472d48cdb
      version: -1
      name: Cloud
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "39"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1557.5,
          "y": 765
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: c53b374c-2b7b-4682-8a5c-8b4979e42132
    type: regular
    task:
      id: c53b374c-2b7b-4682-8a5c-8b4979e42132
      version: -1
      name: Set cloud grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: provider,organization,project,region,other
      val1:
        simple: GCP
      val2:
        simple: n/a
      val3:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: ExtractInbetween
            args:
              from:
                value:
                  simple: projects/
              to:
                value:
                  simple: /global
          filters:
          - - left:
                iscontext: true
                value:
                  simple: GoogleCloudCompute.Instances.networkInterfaces.accessConfigs.natIP
              operator: isEqualString
              right:
                iscontext: true
                value:
                  simple: inputs.RemoteIP
      val4:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
      val5:
        complex:
          root: folder-ids
          transformers:
          - operator: uniq
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: c7cdc306-eddf-4b4b-89d4-561eb30c1963
    type: title
    task:
      id: c7cdc306-eddf-4b4b-89d4-561eb30c1963
      version: -1
      name: Tags
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: a1535aea-1ceb-4d44-8077-d874496ebd79
    type: regular
    task:
      id: a1535aea-1ceb-4d44-8077-d874496ebd79
      version: -1
      name: Set tags grid field
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: key,value,source
      val1:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: keys(@)
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: labels
          transformers:
          - operator: jmespath
            args:
              expression:
                value:
                  simple: values(@)
      val3:
        simple: GCP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: f5c1fd26-5f1a-4f01-8ec3-99e0717bf19c
    type: title
    task:
      id: f5c1fd26-5f1a-4f01-8ec3-99e0717bf19c
      version: -1
      name: System IDs
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "58"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 38554309-9e27-4aaf-855a-7faeca226aff
    type: regular
    task:
      id: 38554309-9e27-4aaf-855a-7faeca226aff
      version: -1
      name: Set system IDs grid field (VPC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-VIRTUAL-NET
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: network
          transformers:
          - operator: uniq
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GoogleCloudCompute.Instances.networkInterfaces.accessConfigs.natIP
                iscontext: true
              right:
                value:
                  simple: inputs.RemoteIP
                iscontext: true
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: f4d76f5d-16e5-4ef2-8a33-3d9382a6c541
    type: regular
    task:
      id: f4d76f5d-16e5-4ef2-8a33-3d9382a6c541
      version: -1
      name: Set system IDs grid field (subnet name)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "47"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SUBNET-NAME
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: subnetwork
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ef877865-6535-48ed-8a7b-2965b11b7956
    type: regular
    task:
      id: ef877865-6535-48ed-8a7b-2965b11b7956
      version: -1
      name: Set system IDs grid field (NIC)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-NIC
      val2:
        complex:
          root: GoogleCloudCompute.Instances.networkInterfaces
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 2e31367e-fcec-44d2-8a22-6aedde8fde20
    type: regular
    task:
      id: 2e31367e-fcec-44d2-8a22-6aedde8fde20
      version: -1
      name: Set system IDs grid field (GCE ID)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ID
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: id
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "26":
    id: "26"
    taskid: a5561453-142a-434e-8415-eae287caefcc
    type: regular
    task:
      id: a5561453-142a-434e-8415-eae287caefcc
      version: -1
      name: Set system IDs grid field (ZONE)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "27"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ZONE
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: zone
          transformers:
          - operator: uniq
          - operator: RegexExtractAll
            args:
              error_if_no_match: {}
              ignore_case: {}
              multi_line: {}
              period_matches_newline: {}
              regex:
                value:
                  simple: (?<=zones\/)[^$]+
              unpack_matches: {}
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1460
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: 2ccfa07d-caae-4f68-8487-58d6063a8bf1
    type: regular
    task:
      id: 2ccfa07d-caae-4f68-8487-58d6063a8bf1
      version: -1
      name: Set system IDs grid field (GCE name)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "59"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-NAME
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: name
          transformers:
          - operator: uniq
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1635
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 9b552ddb-7317-4606-8fee-9ee4d9401056
    type: condition
    task:
      id: 9b552ddb-7317-4606-8fee-9ee4d9401056
      version: -1
      name: Are there any tags?
      description: |+
        Check whether there are any tags associated to instances.

      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "49"
      "yes":
      - "18"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GoogleCloudCompute.Instances
                accessor: labels
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: c41eba05-53da-45cf-8217-53b579bccd04
    type: condition
    task:
      id: c41eba05-53da-45cf-8217-53b579bccd04
      version: -1
      name: Is service account field set?
      description: Determines if a service account associated with the Cloud Compute Instance was discovered and set on the alert.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "40"
      "yes":
      - "32"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: GoogleCloudCompute.Instances.serviceAccounts
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: 4390fcd8-78ee-43bf-8bb8-d311b55d06db
    type: regular
    task:
      id: 4390fcd8-78ee-43bf-8bb8-d311b55d06db
      version: -1
      name: Add service account to unranked service owner list
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Example of command:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: ""
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "40"
    scriptarguments:
      gridfield:
        simple: asmserviceownerunrankedraw
      keys:
        simple: name,email,source,timestamp
      val1:
        simple: n/a
      val2:
        complex:
          root: GoogleCloudCompute.Instances
          accessor: serviceAccounts
          transformers:
          - operator: getField
            args:
              field:
                value:
                  simple: email
      val3:
        simple: GCP-SERVICE-ACCOUNT
      val4:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1425
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 60f9f321-4711-43dc-89e4-b65fec38dff1
    type: condition
    task:
      id: 60f9f321-4711-43dc-89e4-b65fec38dff1
      version: -1
      name: Is there GCP project hierarchy information?
      description: Determines if there is GCP hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCPHierarchy.level
                      iscontext: true
                    right:
                      value:
                        simple: project
                accessor: number
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2710
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: c887886c-5d35-4710-8637-25b7e7a48ac0
    type: regular
    task:
      id: c887886c-5d35-4710-8637-25b7e7a48ac0
      version: -1
      name: Set system IDs grid field (Project-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: GCP-Project-Number
      val2:
        complex:
          root: GCPHierarchy
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: GCPHierarchy.level
                iscontext: true
              right:
                value:
                  simple: project
          accessor: number
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: projects/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 58728ade-8dc7-4c44-85a0-221551e6260d
    type: condition
    task:
      id: 58728ade-8dc7-4c44-85a0-221551e6260d
      version: -1
      name: Is there GCP folder hierarchy information?
      description: Determines if there is GCP folder hierarchy information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "43"
      "yes":
      - "36"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GCPHierarchy.number
                filters:
                - - operator: containsGeneral
                    left:
                      value:
                        simple: GCPHierarchy.number
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: b56996bd-f7ab-4c00-8f89-c7cbcae16437
    type: regular
    task:
      id: b56996bd-f7ab-4c00-8f89-c7cbcae16437
      version: -1
      name: Set system IDs grid field (Folder-Number)
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: GCP-Folder-Number
      val2:
        complex:
          root: GCPHierarchy.number
          filters:
          - - operator: containsGeneral
              left:
                value:
                  simple: GCPHierarchy.number
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: replace
            args:
              limit: {}
              replaceWith: {}
              toReplace:
                value:
                  simple: folders/
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 3300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "37":
    id: "37"
    taskid: 9b37d486-73da-4763-8897-d9f4e88e8061
    type: regular
    task:
      id: 9b37d486-73da-4763-8897-d9f4e88e8061
      version: -1
      name: Set Folders
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        complex:
          root: GCPHierarchy.id
          filters:
          - - operator: startWith
              left:
                value:
                  simple: GCPHierarchy.id
                iscontext: true
              right:
                value:
                  simple: folders/
          transformers:
          - operator: join
            args:
              separator:
                value:
                  simple: ','
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1802.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: 64c86389-77cc-452d-8345-b1df8bd472fc
    type: regular
    task:
      id: 64c86389-77cc-452d-8345-b1df8bd472fc
      version: -1
      name: Set Folders to n/a
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      key:
        simple: folder-ids
      value:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1402.5,
          "y": 1075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3e127c56-98cb-4570-8bce-ca2547869e33
    type: condition
    task:
      id: 3e127c56-98cb-4570-8bce-ca2547869e33
      version: -1
      name: Are there any folders?
      description: Determines if there is GCP folder information to set in the cloud field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "37"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: GCPHierarchy.id
                filters:
                - - operator: startWith
                    left:
                      value:
                        simple: GCPHierarchy.id
                      iscontext: true
                    right:
                      value:
                        simple: folders/
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1557.5,
          "y": 875
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 89e994c6-11c1-48a8-8a12-d86f9dcecc57
    type: title
    task:
      id: 89e994c6-11c1-48a8-8a12-d86f9dcecc57
      version: -1
      name: Service Owner - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: 9edcdd2d-2c60-4668-89ca-05b0028d1632
    type: regular
    task:
      id: 9edcdd2d-2c60-4668-89ca-05b0028d1632
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "43"
      - "40"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 051320a4-947e-408a-8a69-759160ef5438
    type: regular
    task:
      id: 051320a4-947e-408a-8a69-759160ef5438
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 100,
          "y": 1030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: a65632f3-7ff1-4a8b-892f-8f47d4ddf396
    type: title
    task:
      id: a65632f3-7ff1-4a8b-892f-8f47d4ddf396
      version: -1
      name: System IDs - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 680,
          "y": 3550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: 043b969e-4de9-4b3d-8c8f-aa3f030445ab
    type: title
    task:
      id: 043b969e-4de9-4b3d-8c8f-aa3f030445ab
      version: -1
      name: Complete
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 4280
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: aa1e2a2d-b974-402e-8a11-d0f91755b5b1
    type: title
    task:
      id: aa1e2a2d-b974-402e-8a11-d0f91755b5b1
      version: -1
      name: Closing Steps
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: title
      iscommand: false
      brand: Builtin
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 3750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "47":
    id: "47"
    taskid: 71ddd4ef-68fa-4456-8059-d49adae34c33
    type: regular
    task:
      id: 71ddd4ef-68fa-4456-8059-d49adae34c33
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "61"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: f2c45f6f-6589-43e8-8f47-bafc6be584b8
    type: regular
    task:
      id: f2c45f6f-6589-43e8-8f47-bafc6be584b8
      version: -1
      name: Set false flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "false"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2010,
          "y": 1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: f32c1f2b-b9e4-400c-8510-0bfebcec5438
    type: title
    task:
      id: f32c1f2b-b9e4-400c-8510-0bfebcec5438
      version: -1
      name: Tags - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1535
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: 466c0920-9554-4b40-8a55-6f04c5944115
    type: regular
    task:
      id: 466c0920-9554-4b40-8a55-6f04c5944115
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: eee71b79-4d06-47c8-8f73-24e8cdba89f0
    type: title
    task:
      id: eee71b79-4d06-47c8-8f73-24e8cdba89f0
      version: -1
      name: Private IP - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2402.5,
          "y": 1370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: bc64686e-a2f1-4a34-8e11-f1d9a5acb9fa
    type: regular
    task:
      id: bc64686e-a2f1-4a34-8e11-f1d9a5acb9fa
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 2872.5,
          "y": 1340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 6aacab45-fe97-4b52-8748-6124ce47778e
    type: regular
    task:
      id: 6aacab45-fe97-4b52-8748-6124ce47778e
      version: -1
      name: Set true flag for completed enrichment
      description: Set a value in context under the key you entered.
      type: regular
      iscommand: false
      brand: ""
      script: Set
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_gcp
      value:
        simple: "true"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1705
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 0cf78886-8b9d-4cf0-8a38-d7bf5cb818cc
    type: title
    task:
      id: 0cf78886-8b9d-4cf0-8a38-d7bf5cb818cc
      version: -1
      name: Cloud - End
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 6aae9deb-0480-46f7-8d20-dcf3a71aae26
    type: regular
    task:
      id: 6aae9deb-0480-46f7-8d20-dcf3a71aae26
      version: -1
      name: Set ASM enrichment status to true
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        simple: "true"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1772.5,
          "y": 4110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: f618da33-8e97-4f8d-8508-75f574f80214
    type: condition
    task:
      id: f618da33-8e97-4f8d-8508-75f574f80214
      version: -1
      name: Was enrichment performed?
      description: Check if enrichment was performed by checking for a value of true in the relevant flag variable.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "57"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: asm_enrichment_flag_gcp
            iscontext: true
          right:
            value:
              simple: "true"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1537.5,
          "y": 3890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: 5ab6ba34-6f32-4225-8de1-05fb3201dcc5
    type: regular
    task:
      id: 5ab6ba34-6f32-4225-8de1-05fb3201dcc5
      version: -1
      name: Set ASM enrichment status to false
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: GCP
      val2:
        simple: "false"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 4110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 993fdcc4-0cb1-4117-8f57-80bd56a9418c
    type: regular
    task:
      id: 993fdcc4-0cb1-4117-8f57-80bd56a9418c
      version: -1
      name: Set system IDs grid field (type)
      description: Sets the type of cloud asset to the grid field for the ASM system IDs object.
      type: regular
      iscommand: false
      brand: Builtin
      script: GridFieldSetup
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-TYPE
      val2:
        simple: Google Compute Engine
      val3:
        simple: n/a
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 5a4ae4fb-b994-4852-87b0-5b5e71d6f71d
    type: condition
    task:
      id: 5a4ae4fb-b994-4852-87b0-5b5e71d6f71d
      version: -1
      name: Is there GCP subnet information?
      description: Determines if there is GCP subnet information to set in the system IDs field.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "47"
      "yes":
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: GoogleCloudCompute.Instances.networkInterfaces
                accessor: subnetwork
            iscontext: true
          right:
            value: {}
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 8db196b2-5d37-46e8-8b43-12f87f115dda
    type: regular
    task:
      id: 8db196b2-5d37-46e8-8b43-12f87f115dda
      version: -1
      name: Set hierarchy field
      description: commands.local.cmd.set.incident
      script: Builtin|||setAlert
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      asmassethierarchy:
        complex:
          root: GCPHierarchy
          accessor: id
          transformers:
          - operator: ReverseList
          - operator: substringFrom
            args:
              from:
                value:
                  simple: /
          - operator: join
            args:
              separator:
                value:
                  simple: /
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1547.5,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: GCPOffendingFirewallRule
          operator: isExists
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "61"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "33"
      "yes":
      - "62"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there are GCP potential offending firewall rule(s) found.
      id: c4daf26e-c27f-43ca-8ed7-1351da11ec92
      iscommand: false
      name: Were GCP offending firewall rule(s) found?
      type: condition
      version: -1
    taskid: c4daf26e-c27f-43ca-8ed7-1351da11ec92
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2330
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: FIREWALL-RULE-NAME
      val2:
        simple: ${GCPOffendingFirewallRule}
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 5e448108-d0b1-4285-8481-74d16076594a
      iscommand: false
      name: Set system IDs grid field (offending firewall rule(s))
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 5e448108-d0b1-4285-8481-74d16076594a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 950,
          "y": 2520
        }
      }
view: |-
  {
    "linkLabelsPosition": {
      "29_18_yes": 0.56,
      "31_32_yes": 0.68,
      "33_34_yes": 0.5,
      "33_43_#default#": 0.11,
      "35_36_yes": 0.54,
      "35_43_#default#": 0.2,
      "39_37_yes": 0.63,
      "39_38_#default#": 0.65,
      "3_17_yes": 0.76,
      "4_41_#default#": 0.31,
      "59_22_yes": 0.49,
      "5_41_#default#": 0.41
    },
    "paper": {
      "dimensions": {
        "height": 4325,
        "width": 3152.5,
        "x": 100,
        "y": 20
      }
    }
  }
inputs:
- key: RemoteIP
  value:
    complex:
      root: alert
      accessor: remoteip
  required: false
  description: IP address of service
  playbookInputQuery:
outputs: []
tests:
- No tests (auto formatted)
fromversion: 6.8.0
